<script>
    // ASEGÚRATE DE QUE EL LINK SE VEA ASÍ: https://sheetsu.com/apis/v1.0su/TU_ID
    const API_URL = "https://sheetdb.io/api/v1/851m8ra8nv7bu"; 

    async function cargarDatos() {
        const loader = document.getElementById('loading');
        loader.style.display = 'block';
        loader.innerText = "Conectando con Google Sheets...";

        try {
            // Usamos una petición simple sin "headers" extra para evitar bloqueos
            const res = await fetch(API_URL);
            
            if (!res.ok) {
                throw new Error("Código de error: " + res.status);
            }

            const datos = await res.json();
            
            if (datos && datos.length > 0) {
                dibujar(datos);
                loader.style.display = 'none';
            } else {
                loader.innerText = "Conectado. El Excel está vacío.";
            }
        } catch (e) { 
            loader.innerHTML = `<b style="color:red">Error de Conexión:</b><br>
                                1. Revisa que el link de la API sea correcto.<br>
                                2. Verifica que Google Sheets sea 'Público'.<br>
                                <small>${e.message}</small>`;
            console.error(e);
        }
    }
</script>

